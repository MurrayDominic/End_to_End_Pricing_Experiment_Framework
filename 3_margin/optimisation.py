# maximize sum(retention_i Ã— margin_i)